/**
 * @file
 * Styling for the audiofile component.
 */

@use "sass:string";

/**
 * License for mic SVG below:
 * Font Awesome Free 5.2.0 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 */
$mic-svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path d="M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z" /></svg>';

$stop-svg: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10"><rect x="1" y="1" width="8" height="8" fill="currentColor" /></svg>';

$control-size: 4rem;
$control-icon-size: 2rem;
$control-background-color: #ddd;
$control-color-default: #333;
$control-color-stop: #f33;

/**
 * Replace `$search` with `$replace` in `$string`
 *
 * @param {String} $string - Initial string
 * @param {String} $search - Substring to replace
 * @param {String} $replace - New value
 *
 * @return {String} - Updated string
 */
@function string-replace($string, $search, $replace) {
  $index: string.index($string, $search);

  @if $index {
    @return string.slice($string, 1, $index - 1) + $replace +
      string-replace(
        string.slice($string, $index + string.length($search)),
        $search,
        $replace
      );
  }

  @return $string;
}

/**
 * Add an svg icon inline as background image.
 *
 * @param {String} $svg - The (escaped) svg
 * @param {Color} $color - The color to use as currentColor
 * @param {String} $size - A value for the background-size property
 */
@mixin icon($svg, $color: null, $size: null) {
  @if ($color) {
    $svg: string-replace(
      $svg,
      "currentColor",
      string-replace(#{$color}, "#", "%23")
    );
  }
  background-image: url("data:image/svg+xml;utf8,#{$svg}");
  background-position: center;
  background-repeat: no-repeat;
  @if ($size) {
    background-size: $size;
  }
}

.audiofile-recorder {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 1rem;

  .control {
    width: $control-size;
    height: $control-size;
    margin: 0 auto;
    background-color: $control-background-color;
    border-radius: $control-size / 2;
  }
  .icon-start {
    @include icon($mic-svg, $control-color-default, $control-icon-size);
  }
  .icon-stop {
    @include icon($stop-svg, $control-color-stop, $control-icon-size);
  }
}
